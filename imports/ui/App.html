<body>
    {{> mainContainer}}
</body>


<template name="mainContainer">
    {{#if notReady}} 
    Kobolds gathering...
    {{else}}
    <div class="container">
        <header>
            <h1>{{townName}}</h1>
        </header>
        Resources
        <ul>
            {{#each resource in resources}}
            {{> showResource resource}}
            {{/each}}
        </ul>


        Kobolds
        <ul>
            {{#each kobold in kobolds}}
            {{> showKobold kobold}}
            {{/each}}
        </ul>

        Jobs
        <ul>
            {{#each job in jobs}}
            {{> showJob job}}
            {{/each}}
        </ul>

        Expeditions
        <ul>
            {{#each expo in expos}}
            {{> showExpo expo}}
            {{/each}}
        </ul>
    </div>
    {{/if}}
</template>

<template name="showKobold">
    <div class="clickable js-click-name" style="color: {{color}};">
        {{name}}
    </div>

    {{#if showDetails}}
<div class="details" style="border-color: {{color}};">
    Color: {{color}}
    <br>
    Physical: {{physical}}
    <br>
    Mental: {{mental}}
    <br>
    Social: {{social}}
    <br>
    Current job: {{#if job}}{{job}}{{else}}None{{/if}}
    <button class="js-quit-job">Quit job</button>
    <br>
    <select id="breedSelect">
        <option selected>Breed With</option>
        {{#each otherKobold in kobolds}}
            {{#unless isCurrentKobold otherKobold.id}}
                <option style="color: {{otherKoboldColor otherKobold.id}};" value="{{otherKobold.id}}">{{otherKobold.name}}</option>
            {{/unless}}
        {{/each}}
    </select>
    <button class="js-breed">Confirm</button>
    
    <br>

    <select id="jobSelect">
        <option selected>Chose job</option>
        {{#each job in jobs}}
            <option style="color: {{job.color}};" value="{{job.name}}">{{job.name}}</option>
        {{/each}}
    </select>
    <button class="js-chose-job">Confirm</button>
</div>
    {{/if}}
    
    <br>
</template>

<template name="showResource">
    <div class="clickable js-click-name" style="color: {{color}};">
        {{name}}: {{stockpile}}
    </div>

    {{#if visible}}
        {{#if showDetails}}
            <div class="details" style="border-color: {{color}};">
                Stockpile: {{stockpile}}
            </div>
        {{/if}}
    {{/if}}

    <br>
</template>

<template name="showJob">
    <div class="clickable js-click-name" style="color: {{color}};">
        {{name}}
    </div>
</template>

<template name="showExpo">
    <div class="clickable js-click-name" style="color: {{color}};">
        {{name}}
    </div>
</template>